using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.ActionConstraints;
using System.Net.Http.Json;
using System.Security.Cryptography;
using System.Text.Json;
using System.Text.RegularExpressions;

namespace CS_AI.Services;

public class LmStudioService
{
    private readonly HttpClient _httpClient;

    public LmStudioService(HttpClient httpClient)
    {
        _httpClient = httpClient;
    }

    public async Task<string> GenerateTextAsync(string prompt, string sessionId)
    {
        var request = new
        {
            model = "phi-4-mini-instruct",
            //model = "phi-3-mini-4k-instruct",
            session_id = sessionId,
            messages = new[]
           {
                new { role = "system", content = "Anda adalah Customer Service perusahaan melalui WhatsApp.\r\nTugas Anda hanya membantu proses reset password akun perusahaan.\r\n\r\nGAYA BAHASA:\r\n- Bahasa Indonesia sopan dan ramah.\r\n- Kalimat singkat dan jelas (1–2 kalimat).\r\n- Satu pertanyaan per pesan.\r\n- Tidak kaku dan tidak terlalu formal.\r\n- Tidak menggunakan emoji.\r\n\r\nATURAN:\r\n- Fokus hanya pada reset password.\r\n- Ikuti alur secara berurutan.\r\n- Jangan mengarang data.\r\n- Jangan menjawab topik lain.\r\n- Jangan mengklaim mengirim OTP.\r\n\r\nALUR RESET PASSWORD:\r\n1. Minta username, email, dan nomor kontak terdaftar secara bersamaan.\r\n2. Tunggu OTP dari sistem.\r\n3. Minta kode OTP.\r\n4. Konfirmasi hasil.\r\n5. Jika pengguna mengirimkan \"Anggap saja sudah lengkap\", kirim pesan *\"GENERATE OTP\"*.\r\n\r\nJika pengguna bertanya di luar proses, jawab dengan sopan:\r\n\"kami bantu proses reset password terlebih dahulu, ya.\"\r\n\r\nSELALU balas dengan format JSON:\r\n{\r\n  \"message\": \"pesan WhatsApp ke pengguna\",\r\n  \"action\": \"ask_information | wait_backend | ask_otp | verify_otp | done\"\r\n}\r\n" },
                //new { role = "system", content = "You are a Document Verification AI.\r\n\r\nREFERENCE DOCUMENT:\r\nKLAUSUL STANDAR KONTRAK\r\n\r\nPT VISIONET DATA INTERNASIONAL\r\n\r\nNo | Topik | Inti Klausul | Risk | Note\r\n1 | Force Majeure / Keadaan Memaksa | Ada pasal tentang Force Majeure/ Keadaan Memaksa | High | All\r\n2 | Service Level Agreement (SLA)/ Standard Kinerja | Ada ketentuan tentang SLA/Standar Kinerja | Medium | All\r\n3 | Ganti Rugi | Pengenaan ganti rugi jika terbukti kesalahan Vendor terhadap fasilitas maupun karyawan VDI | High | All\r\n4 | Ketentuan Pajak | Ketentuan perpajakan mengikuti peraturan perpajakan yang berlaku di Indonesia | Medium | All\r\n5 | Kerahasiaan | Terdapat pasal yang mengatur kerahasiaan/informasi rahasia | High | All\r\n6 | Penyelesaian Perselisihan | Terdapat ketentuan penyelesaian perselisihan secara mufakat dan Pengadilan | Medium | All\r\n7 | Pelindungan Data Pribadi | Terdapat pasal yang mengatur pelindungan data pribadiMerujuk ke UU PDPAda ketentuan bahwa masing-masing pihak bertanggungjawab atas pelanggaran data pribadi | High | All\r\n8 | Anti Korupsi & Penyuapan | Terdapat pasal yang mengatur anti korupsi dan penyuapan | Medium | All\r\n9 | Pemberitahuan / Korespondensi | Terdapat pasal pemberitahuan / korespondensi | Low | All\r\n10 | Addendum / Perubahan | Terdapat pasal pengaturan penambahan dan/atau peraturan akan disepakati secara tertulis lewat addendum | Low | All\r\n11 | Pernyataan dan Jaminan | Ada ketentuan tentang pernyataan dan jaminan para pihak | High | All\r\n12 | Hak Kekayaan Intelektual | Ada ketentuan tentang hak kekayaan intelektual Perjanjian tidak melimpahkan hak kekayaan intelektual | Medium | All\r\n13 | Cyber Risk | Vendor bertanggung jawab atas cyber attack, malware, hacking, data breach kecuali akibat kesalahannya | High | Perjanjian jasa\r\n14 | Perubahan Kepemilikan / Change of Control | Perjanjian tetap berlaku apabila terjadi perubahan kepemilikan/change of control sampai dengan akhir jangka waktu dengan pemilik baru tunduk kepada perjanjian existing | Medium | All\r\n15 | Bahasa yang berlaku | Perjanjian dibuat dalam 2 bahasa, bahasa indonesia yang berlaku | Medium | Hanya berlaku di kontrak bilingual\r\n16 | Outsourcing | Hubungan kerja tenaga outsourcing adalah dengan vendorVendor wajib mengikuti seluruh peraturan ketenagakerjaan (UMR, BPJS, dll) dan membebaskan VDI dari gugatan dan tuntutanTidak boleh dialihkan/subkontrak ke pihak lain tanpa persetujuan VDI | High | Hanya berlaku di perjanjian outsource\r\n17 | Biaya Pekerjaan | Biaya pekerjaan bersifat tetap selama jangka waktu perjanjian |  | All\r\n\r\nUPLOADED DOCUMENT (OCR RESULT):\r\nPERJANJIAN KERJA SAMA PEMBELIAN BARANG\r\n\r\nantara\r\n\r\nPT VISIONET DATA INTERNASIONAL\r\n\r\ndengan\r\n\r\nPT SANJAYA AMAR PERSADA SAWANGAN.\r\n\r\nNomor : 001/SPK-VDI/XII/2025 [*]\r\n\r\nPerjanjian Kerja Sama Pembelian Barang (selanjutnya disebut sebagai \"Perjanjian\") ini dibuat pada hari Senin tanggal Tiga November dua ribu duah puluh lima [ - 12 - 2025] oleh dan antara :\r\n\r\n1PT Visionet Data Internasional, suatu perseroan terbatas yang didirikan berdasarkan hukum Negara Republik Indonesia, berkedudukan di Jakarta Selatan, berkedudukan di Sopo Del Office Towers & Lifestyle Tower B Lantai 18, Jalan Mega Kuningan Barat III Lot 10 1-6, Kawasan Mega Kuningan, Jakarta Selatan 12950, dalam hal ini diwakili oleh Suyanto Halim dan Jak Tanti, masing-masing bertindak dalam kapasitasnya sebagai Presiden Direktur dan Direktur, untuk dari dan oleh karenanya berhak bertindak untuk atas PT Visionet Data Internasional, selanjutnya disebut \"Pihak Pertama\".\r\n\r\n2PT .Sanjaya Amar Persada Sawangan.., suatu perseroan terbatas yang didirikan berdasarkan hukum Negara Republik Indonesia, berkedudukan di BSI Blok G1 No.129 RT 001 RW 012 Kelurahan Pengasinan, Kecamatan Sawangan Kota Depok 16518 Kabupaten Bekasi Provinsi Jawa Barat, dalam hal ini diwakili oleh Bambang Jaya Supena...., bertindak dalam kapasitasnya sebagai Direktur Utama, untuk dari dan oleh karenanya berhak bertindak untuk atas nama Direksi mewakili PT Sanjaya Amar Persada Sawangan..., selanjutnya disebut \"Pihak Kedua\"\r\n\r\nPihak Pertama dan Pihak Kedua untuk selanjutnya secara bersama-sama disebut sebagai \"Para Pihak\" atau secara sendiri-sendiri sebagai \"Pihak\".\r\n\r\nPara Pihak dalam terlebih dahulu menerangkan sebagai berikut :\r\n\r\n1Bahwa Pihak Pertama adalah perusahaan yang bergerak di bidang teknologi informasi yang dalam kegiatan usahanya membutuhkan Barang untuk menunjang kegiatan operasionalnya.\r\n\r\n2Bahwa Pihak Kedua adalah perusahaan yang bergerak di bidang penyediaan sparepart Automated Teller Machine (ATM) dan sanggup untuk menyediakan kebutuhan bagi Pihak Pertama.\r\n\r\n3Bahwa Para Pihak bermaksud untuk melakukan kerja sama pengadaan Barang (sebagaimana akan didefinisikan di bawah) di mana Pihak Kedua bertindak selaku penjual dan Pihak Pertama selaku pembeli sesuai purchase order (PO).\r\n\r\nBerdasarkan hal-hal tersebut di atas Para Pihak dalam kedudukannya masing-masing sepakat untuk mengikatkan diri dalam Perjanjian ini dengan syarat-syarat dan ketentuan sebagai berikut:\r\n\r\nPASAL 1\r\n\r\nRUANG LINGKUP KERJA SAMA\r\n\r\n1Pihak Pertama akan melakukan pembelian kepada Pihak Kedua barang/produk (selanjutnya disebut \"Barang\") sesuai dengan kebutuhan Pihak Pertama sebagaimana ditentukan pada Purchase Order (PO) yang diterbitkan oleh Pihak Pertama kepada Pihak Kedua sebagaimana dirinci dalam Lampiran 1 Perjanjian ini.\r\n\r\n2Rincian jumlah, jenis, harga, spesifikasi, dan garansi Barang adalah sebagaimana ditentukan dalam PO.\r\n\r\n3Syarat dan ketentuan pelaksanaan dari seluruh PO yang diterbitkan oleh Pihak Pertama kepada Pihak Kedua adalah sebagaimana diatur dan tunduk dalam Perjanjian ini.\r\n\r\n4Kerja sama antara Para Pihak ini dibuat dengan prinsip, yaitu tidak ada PO dari Pihak Pertama maka tidak ada kewajiban bagi Pihak Kedua untuk melakukan pekerjaan.\r\n\r\n5Kerja sama ini dibuat secara non-ekslusif. Pihak Pertama berhak untuk melakukan kerja sama untuk Barang sejenis dengan pihak ketiga manapun.\r\n\r\nPASAL 2\r\n\r\nJANGKA WAKTU\r\n\r\nPerjanjian ini berlaku terhitung sejak tanggal ditandatanganinya Perjanjian ini sebagaimana tertulis pada awal Perjanjian, yaitu tanggal 13 November15 Januari 2025 sampai dengan terpenuhinya seluruh hak dan kewajiban berdasarkan Perjanjian ini, termasuk masa garansi Barang\r\n\r\nPASAL 3\r\n\r\nPENYERAHAN DAN/ATAU PENGIRIMAN BARANG\r\n\r\n1Para Pihak setuju dan sepakat bahwa penyerahan dan/atau pengiriman Barang kepada Pihak Pertama akan dilakukan oleh Pihak Kedua ke alamat yang tercantum dalam PO, dengan ketentuan pada saat penyerahan Barang tersebut akan ditandatangani Berita Acara Serah Terima (BAST) oleh Para Pihak atau perwakilan yang ditunjuknya.\r\n\r\n2Jangka waktu pengiriman Barang dari Pihak Kedua kepada Pihak Pertama adalah selambat-lambatnya selama 7 (tujuh) hari kalender dari PO yang telah diterbitkan oleh Pihak Pertama (selanjutnya disebut \"Jangka Waktu Pengiriman\").\r\n\r\n3Pihak Pertama akan melakukan pengecekan terhadap Barang dalam jangka waktu maksimal 7 (tujuh) hari kerja setelah Barang diterima oleh Pihak Pertama, setelah melebihi 7 (tujuh) hari kerja tersebut, apabila ditemukan cacat atau kerusakan terhadap Barang, maka Pihak Kedua wajib melakukan perbaikan terhadap Barang atau mengganti Barang yang baru tanpa mengenakan biaya kepada Pihak Pertama.\r\n\r\nPASAL 4\r\n\r\nHARGA PEMBELIAN DAN CARA PEMBAYARAN\r\n\r\n1Harga Pembelian Barang adalah sebagaimana yang tercantum dalam PO. Harga sebagaimana dalam PO tidak dapat diubah dan tetap selama pelaksanaannya .\r\n\r\n2Pihak Pertama wajib membayarkan Harga Pembelian Barang kepada Pihak Kedua selambat-lambatnya dalam waktu [30] hari kalender setelah Pihak Pertama menerima dokumen tagihan yang lengkap dan akurat dari Pihak Kedua. Dalam hal hari ke-30 (ketiga puluh) tersebut jatuh pada hari setelah hari Senin sesuai dengan jadwal pembayaran yang berlaku di Pihak Pertama, maka pembayaran akan dilakukan pada hari Senin berikutnya (selanjutnya disebut \"Jangka Waktu Pembayaran\").\r\n\r\n3Dokumen penagihan sebagaimana dimaksud dalam ayat 2 Pasal ini sekurang-kurangnya terdiri dari :\r\n\r\n1Invoice asli\r\n\r\n2Faktur Pajak\r\n\r\n3Surat jalan asli / BAST yang sudah ditand tangan perwakilan Pihak Pertama)\r\n\r\n4PO dan Copy Perjanjian\r\n\r\n4Pembayaran Harga Pembelian Barang sebagaimana dimaksud Pasal ini dilakukan melalui transfer dari Pihak Pertama ke rekening Pihak Kedua sebagai berikut :\r\n\r\nBank: Mandiri\r\n\r\nNomor Rekening: 157-00-0684942-7\r\n\r\nAtas Nama: PT.SANJAYA AMAR PERSADA SAWANGAN..\r\n\r\n5Apabila tidak disebutkan di dalam PO maka seluruh pajak yang timbul dari pelaksanaan Perjanjian ini menjadi tanggung jawab dan wajib dibayarkan oleh masing-masing pihak sesuai ketentuan hukum yang berlaku.\r\n\r\nPasal 5\r\n\r\nHAK DAN KEWAJIBAN PARA PIHAK\r\n\r\n1Pihak Pertama memiliki Hak dan Kewajiban sebagai berikut :\r\n\r\n1Berhak menerima Barang dari Pihak Kedua sesuai jadwal, spesifikasi dan jumlah yang diatur dalam PO.\r\n\r\n2Berhak memeriksa dan memverifikasi Barang yang dikirimkan oleh Pihak Kedua, apabila menurut Pihak Pertama Barang yang dikirimkan oleh Pihak Kedua tidak sesuai dengan spesifikasi dan kualitas terbaik, Pihak Pertama berhak mengembalikan Barang tersebut dan tidak melakukan pembayaran atas barang tersebut.\r\n\r\n3Berhak mendapatkan garansi atas Barang dari Pihak Kedua sesuai ketentuan dalam Perjanjian ini atau mendapatkan dukungan (support) dari Pihak Kedua dalam hal proses pengajuan klaim garansi atas Barang dari pembuat barang (apabila ada).\r\n\r\n4Apabila setelah Barang diterima oleh Pihak Pertama ditemukan cacat tersembunyi pada Barang, baik karena cacat produksi, kerusakan karena handling pengiriman dari Pihak Kedua ke Pihak Pertama, maka Pihak Pertama berhak menerima barang pengganti segera setelah Pihak Pertama memberikan informasi mengenai hal tersebut kepada Pihak Kedua.\r\n\r\n5Berhak untuk mendapatkan informasi yang relevan dan/atau transfer knowledge atas hasil Pekerjaan serta cara pengoperasian dan perawatan Barang dari Pihak Kedua;\r\n\r\n6Berhak mendapatkan informasi yang relevan atas pekerjaan untuk keperluan audit baik dari internal Pihak Pertama dan/atau audit eksternal yang ditunjuk Pihak Pertama atau pelanggan Pihak Pertama.\r\n\r\n7Bila diperlukan, Pihak Pertama berhak mendapatkan Laporan Keuangan terkini yang telah diaudit setiap tahun dan/atau laporan hasil pemeriksaan pihak independen sesuai objek Perjanjian secara berkala (bila diperlukan).\r\n\r\n8Pihak Pertama wajib membayar Harga Pembelian Barang kepada Pihak Kedua sesuai harga yang disepakati oleh Para Pihak yang tercantum di PO dengan Jangka Waktu Pembayaran yang telah disepakati oleh Para Pihak sebagaimana tertulis dalam Perjanjian ini.\r\n\r\n9Wajib untuk menunjuk seorang Person In Charge (PIC) dari Pihak Pertama untuk berkomunikasi dengan Pihak Kedua perihal pelaksanaan Perjanjian. Seluruh komunikasi dari dan/atau kepada PIC tersebut dengan Pihak Kedua dianggap telah disampaikan secara layak dan cukup dari dan/atau kepada Pihak Pertama. Pihak Pertama pada setiap waktu berhak mengganti PIC yang ditunjuknya dengan pemberitahuan kepada Pihak Kedua.\r\n\r\n2Hak dan Kewajiban Pihak Kedua:\r\n\r\n1Berhak mengirimkan Invoice kepada Pihak Pertama dan menerima pembayaran atas Harga Barang sesuai dengan PO yang telah disepakati Para Pihak, sesuai dengan Jangka Waktu Pembayaran dalam Perjanjian ini.\r\n\r\n2Pihak Kedua wajib untuk menyerahkan Barang yang dipesan oleh Pihak Pertama sesuai dengan Jangka Waktu Pengiriman yang tercantum pada masing-masing PO. Dalam hal Pihak Kedua lalai dan/atau melanggar ketentuan ayat ini, maka Pihak Kedua akan dikenakan denda sebagaimana diatur dalam Perjanjian ini.\r\n\r\n3Pihak Kedua wajib dan menjamin bahwa Barang yang dijual oleh Pihak Kedua merupakan Barang dengan kualitas terbaik, asli, memenuhi spesifikasi yang ditentukan oleh Pihak Pertama dengan spesifikasi sesuai produk, dalam kondisi baru dan bebas dari cacat tersembunyi.\r\n\r\n4Pihak Kedua wajib untuk menyediakan garansi Barang sesuai dengan ketentuan Perjanjian ini atau memberikan upaya terbaiknya dalam membantu Pihak Pertama dalam proses pengajuan klaim garansi atas Barang dari pembuat Barang.\r\n\r\n5Pihak Kedua wajib memperhatikan dan menjaga keamanan dan keselamatan kerja bagi tenaga kerjanya pada saat pelaksanaan Perjanjian ini, sesuai dengan ketentuan perundang-undangan yang berlaku di Indonesia. Apabila terjadi kecelakaan kerja terhadap tenaga kerja Pihak Kedua, maka Pihak Kedua berkewajiban untuk bertanggung jawab terhadap seluruh biaya yang timbul akibat kecelakaan kerja tersebut.\r\n\r\n6Wajib melakukan transfer knowledge kepada Pihak Pertama dan/atau Pelanggan Pihak Pertama mengenai hasil pekerjaan serta cara pengoperasian dan perawatan Barang kepada Pihak Pertama.\r\n\r\n7Wajib menyediakan informasi yang relevan atas pekerjaan untuk keperluan audit baik dari internal Pihak Pertama dan/atau audit eksternal yang ditunjuk Pihak Pertama atau pelanggan Pihak Pertama.\r\n\r\n8Wajib menyampaikan laporan keuangan terkini yang telah diaudit setiap tahun dan/atau laporan hasil pemeriksaan pihak independen sesuai objek Perjanjian secara berkala (bila diperlukan).\r\n\r\n9Pihak Kedua tidak diperkenankan untuk mengalihkan hak dan kewajibannya dalam Perjanjian ini baik sebagian maupun seluruhnya kepada pihak lain kecuali dengan persetujuan tertulis terlebih dahulu dari Pihak Pertama.\r\n\r\n10Dalam hal Pihak Pertama menyetujui pengalihan atas sebagian atau seluruh pelaksanaan Perjanjian ini kepada pihak lain, Pihak Kedua wajib bertanggung jawab atas pengawasan dan hasil pekerjaan tetap sesuai dengan Perjanjian ini.\r\n\r\n11Pihak Kedua wajib dan menyatakan kepada Pihak Pertama bahwa Pihak Kedua memiliki wewenang dan seluruh izin yang diperlukan untuk melaksanakan Perjanjian ini, misalnya izin sebagai penjual/distributor/perwakilan, atau izin-izin lain yang dipersyaratkan oleh hukum.\r\n\r\nPASAL 6\r\n\r\nGARANSI\r\n\r\n2.1Pihak Kedua wajib menyediakan garansi resmi atas setiap Barang yang dibeli oleh Pihak Pertama, sesuai dengan ketentuan dan jangka waktu garansi sebagaimana diatur dalam Lampiran 2 Perjanjian atau sesuai yang disediakan oleh distributor resmi Barang. Garansi resmi yang dimaksud adalah garansi dari pembuat Barang.\r\n\r\n2.2Jangka waktu garansi sebagaimana dalam ayat 1 Pasal ini juga berlaku untuk cacat tersembunyi atau cacat produksi pada Barang. Apabila Pihak Pertama menemukan adanya cacat tersembunyi dan/atau cacat produksi pada Barang maka Pihak Kedua wajib segera mengganti barang yang cacat tersebut dengan barang pengganti yang sama atau lebih tinggi atau sesuai dengan ketentuan yang berlaku dan disepakati bersama.\r\n\r\nPASAL 7\r\n\r\nDENDA DAN GANTI RUGI\r\n\r\n1Setiap keterlambatan Pihak Kedua atas pengiriman Barang akan dikenakan denda sebesar 1% (satu permil) dari Harga Pembelian Barang dengan yang mengalami keterlambatan untuk tiap hari keterlambatan, dengan maksimum denda keterlambatan sebesar 5% (lima persen). Total denda tersebut akan diberlakukan sebagai potongan dari tagihan Pihak Kedua kepada Pihak Pertama.\r\n\r\n2Apabila total denda keterlambatan telah mencapai 5% (lima persen), maka Pihak Pertama berhak untuk mengakhiri Perjanjian ini (berikut dengan PO yang terkait) tanpa kewajiban pembayaran apapun kepada Pihak Kedua, termasuk namun tidak terbatas pada Harga Pembelian Barang yang telah dibeli oleh Pihak Kedua yang mengalami keterlambatan. Jika ada Uang Muka/Down Payment (DP) yang telah dibayarkan oleh Pihak Pertama, maka DP wajib dikembalikan oleh Pihak Kedua kepada Pihak Pertama.\r\n\r\n3Apabila Pihak Kedua terbukti melaksanakan pekerjaan dengan standar Barang yang berbeda atau tidak sesuai dengan yang telah ditentukan dan disepakati oleh Para Pihak, baik secara kuantitas maupun kualitas, maka Pihak Kedua wajib mengganti seluruh ketidaksesuaian itu dengan spesifikasi yang sesuai atas biayanya sendiri dan wajib tetap memenuhi jadwal pelaksanaan pekerjaan. Dalam hal proses ini menyebabkan keterlambatan penyerahan pekerjaan, maka ketentuan denda pada ayat (1) dan (2) pasal ini akan berlaku.\r\n\r\n4Keberlakuan denda dikecualikan apabila keterlambatan penyelesaian Pekerjaan ini disebabkan karena keadaan memaksa/force majeure.\r\n\r\n5Apabila dalam melakukan pekerjaan, terdapat kerusakan dan/atau kehilangan pada barang, peralatan, dan/atau material lain milik Pihak Pertama yang disebabkan oleh kesalahan/kelalaian Pihak Kedua dan/atau tenaga kerjanya, maka Pihak Kedua wajib untuk memperbaiki dan/atau mengganti seluruh kerusakan tersebut sesuai dengan total nilai kerusakan yang terjadi dengan biayanya sendiri. Pelanggaran atas kewajiban ini oleh Pihak Kedua akan menyebabkan Pihak Pertama memiliki hak untuk menahan pembayaran kepada Pihak Kedua.\r\n\r\nPASAL 8\r\n\r\nFORCE MAJEURE\r\n\r\n1Yang termasuk sebagai Force Majeure adalah kejadian-kejadian yang dengan segala daya dan supaya tidak dapat diduga dan tidak dapat diatasi oleh Para Pihak, termasuk namun tidak terbatas pada peristiwa-peristiwa:\r\n\r\n1Bencana alam, kebakaran, wabah penyakit;\r\n\r\n2Perang, huru-hara, pemberontakan, terorisme, sabotase, embargo, kegagalan sistem kerja salah satu pihak dan/atau pemogokan massal;\r\n\r\n3Peraturan dari pemerintah atau instansi yang berwenang yang secara langsung atau tidak langsung mempengaruhi pelaksanaan Perjanjian, dimana terdapat larangan-larangan dari Pemerintah yang dapat menghambat bagi Para Pihak untuk dapat menjalani Perjanjian ini.\r\n\r\n2Keterlambatan atau kegagalan salah satu Pihak dalam melaksanakan salah satu kewajibannya berdasarkan Perjanjian ini bukan merupakan suatu pelanggaran terhadap Perjanjian ini apabila dan selama hal demikian disebabkan oleh Force Majeure.\r\n\r\n3Dalam hal terjadi kejadian Force Majeure sebagaimana dimaksud diatas sehingga mempengaruhi pelaksanaan kewajiban salah satu pihak, maka pihak yang mengalami keadaan Force Majeure berkewajiban untuk memberitahukan secara tertulis kepada pihak yang lainnya selambat-lambatnya 7 (tujuh) hari kerja terhitung sejak terjadinya keadaan Force Majeure, untuk diselesaikan secara musyawarah.\r\n\r\n4Apabila Force Majeure berakhir atau telah teratasi, maka Pihak yang mengalami Force Majeure harus segera melaksanakan kewajibannya berdasarkan Perjanjian ini yang tertunda karena Force Majeure. Namun demikian, dalam hal Force Majeure berlangsung selama lebih dari 30 (tiga puluh) hari kalender, maka Para Pihak berhak untuk mengakhiri Perjanjian ini.\r\n\r\n5Apabila pihak yang mengalami Force Majeure lalai atau terlambat untuk memberitahukan kepada pihak yang lainnya dalam kurun waktu sebagaimana dimaksud dalam ayat (3) Pasal ini, maka seluruh kerugian, risiko dan konsekuensi yang mungkin timbul menjadi beban dan tanggung-jawab Pihak yang mengalami Force Majeure.\r\n\r\nPasal 9\r\n\r\nKERAHASIAAN\r\n\r\n1Informasi Rahasia adalah data-data dan informasi-informasi apapun yang disepakati oleh Para Pihak untuk dirahasiakan yang diterima oleh Pihak yang menerima Informasi Rahasia (\"Pihak Penerima\") dari pihak yang mengungkapkan Informasi Rahasia (\"Pihak Pemberi\") yang digunakan dalam pelaksanaan Perjanjian ini. Masing-masing Pihak tanpa persetujuan tertulis terlebih dahulu tidak akan membuka, memperlihatkan ataupun memberitahukan Informasi Rahasia yang diterimanya kepada pihak ketiga kecuali mendapat persetujuan tertulis dari Pihak Pemberi.\r\n\r\n2Informasi Rahasia tidak termasuk hal-hal sebagai berikut:\r\n\r\n1Telah diketahui oleh umum pada saat diberikan oleh Pihak Penerima;\r\n\r\n2Dalam waktu selanjutnya diketahui oleh umum yang bukan disebabkan karena kesalahan Pihak Penerima;\r\n\r\n3Telah memperoleh persetujuan tertulis dari Pihak Pemberi;\r\n\r\n4Informasi harus diberikan berdasarkan penetapan/keputusan pengadilan atau arbitrase.\r\n\r\n3Informasi Rahasia dalam bentuk apapun harus segera dikembalikan, dihapuskan atau dimusnahkan termasuk seluruh salinannya oleh Pihak Penerima dalam jangka waktu 10 (sepuluh) Hari Kalender sejak diterimanya pemberitahuan tertulis dari Pihak Pemberi.\r\n\r\n4Ketentuan Pasal ini akan tetap berlaku meskipun Perjanjian ini telah berakhir.\r\n\r\nPASAL 10\r\n\r\nPELINDUNGAN DATA PRIBADI\r\n\r\n1Pihak Kedua bertanggung jawab untuk memastikan proses Data Pribadi (apabila ada) sesuai dengan ketentuan Undang-Undang No. 27 Tahun 2022 tentang Pelindungan Data Pribadi, berikut segala tambahan, perubahan/amandemennya di kemudian hari (\"UU PDP\"), maupun ketentuan lain terkait perlindungan Data Pribadi dan privasi (\"Data Pribadi\"). Pihak Kedua menyatakan dan menjamin bahwa Pihak Kedua menjaga praktik dan prosedur perlindungan informasi yang mematuhi UU PDP.\r\n\r\n2Dalam hal terbukti terjadi kegagalan Pelindungan Data Pribadi yang diketahui oleh Pihak Kedua, maka Pihak Kedua wajib menyampaikan pemberitahuan tertulis paling lambat 3 x 24 jam kepada Pihak Pertama dengan Pemberitahuan tertulis dimaksud minimal memuat:\r\n\r\n1Data Pribadi yang terungkap;\r\n\r\n2Kapan dan Bagaimana Data Pribadi terungkap; dan\r\n\r\n3Upaya penanganan dan pemulihan atas terungkapnya Data Pribadi yang telah Pihak Kedua dan/atau karyawan Pihak Kedua lakukan.\r\n\r\n3Pihak Kedua bertanggung jawab atas kerugian yang diakibatkan oleh adanya kegagalan Pelindungan Data Pribadi milik Pihak Pertama yang menjadi tanggung jawabnya dan terbukti disebabkan karena kesalahan Pihak Kedua.\r\n\r\nPASAL 11\r\n\r\nHAK KEKAYAAN INTELEKTUAL\r\n\r\n1Pihak Kedua wajib menjamin bahwa Pekerjaan yang disediakan untuk Pihak Pertama tidak melanggar hak cipta, paten, merek, desain, model, lisensi, rahasia dagang, atau Hak Kekayaan Intelektual (HKI) lainnya sebagaimana diatur dalam ketentuan hukum yang berlaku di Republik Indonesia maupun ketentuan hukum yang diberlakukan secara internasional sehubungan dengan pelaksanaan Pekerjaan;\r\n\r\n1Pihak Kedua wajib memberi perlindungan bagi Pihak Pertama dan akan, atas biayanya, membela atau menyelesaikan klaim, gugatan, tindakan atau proses hukum yang diajukan dari pihak lainnya terhadap Pihak Pertama sejauh bahwa tindakan tersebut adalah berdasarkan adanya informasi bahwa Pekerjaan yang diserahkan dari Pihak Kedua kepada Pihak Pertama mengandung pelanggaran HKI sebagaimana tersebut pada ayat 1 di atas;\r\n\r\n2Apabila timbul tuntutan/klaim sebagaimana dimaksud pada ayat (2), Pihak Kedua wajib melakukan hal-hal sebagai berikut:\r\n\r\n1Mengubah atau mengganti bagian pekerjaan yang dinyatakan terbukti melanggar HKI dengan bagian yang baru (sehingga tidak melanggar ketentuan-ketentuan hukum atas HKI) dengan biaya ditanggung Pihak Kedua; perubahan dimaksud tidak akan merubah substansi dari fungsi Pekerjaan itu sendiri;\r\n\r\n2Mengupayakan perolehan dan/atau pembelian bagian dari Pekerjaan yang terbukti melanggar HKI dengan biaya ditanggung Penyedia untuk kepentingan Pihak Pertama tanpa merubah Harga Pembelian Barang;\r\n\r\n3Mengambil kembali seluruh pekerjaan yang terbukti melanggar HKI dengan memberi kompensasi finansial kepada Pihak Pertama sebesar 100% (seratus persen) dari Harga Pembelian Barang yang terbukti melanggar HKI; dan\r\n\r\n4Memberi kompensasi biaya kepada Pihak Pertama, apabila ada, atas biaya pengacara dalam jumlah yang wajar yang telah dikeluarkan Pihak Pertama yang berkaitan dengan klaim pekerjaan yang melanggar HKI pihak lainnya.\r\n\r\n3Pilihan atas pelaksanaan ketentuan pada ayat 3 Pasal ini, merupakan hak sepenuhnya bagi Pihak Pertama;\r\n\r\nPASAL 12\r\n\r\nPENGAKHIRAN PERJANJIAN\r\n\r\n1Perjanjian ini akan berakhir setelah seluruh hak dan kewajiban dari masing-masing Pihak terpenuhi, termasuk namun tidak terbatas pada pengiriman Barang, perbaikan Barang dan pembayaran Harga Pembelian Barang.\r\n\r\n2Masing-masing Pihak berhak mengakhiri Perjanjian ini sebelum berakhirnya Jangka Waktu Perjanjian, dengan memberikan pemberitahuan tertulis kepada Pihak lainnya minimal 30 (tiga puluh) hari kalender sebelum tanggal efektifnya pengakhiran.\r\n\r\n3Salah satu Pihak berhak untuk mengakhiri Perjanjian ini dengan mengirimkan pemberitahuan tertulis yang berlaku seketika, apabila terjadi salah satu hal berikut ini :\r\n\r\n1Apabila salah satu Pihak gagal melaksanakan salah satu kewajibannya berdasarkan Perjanjian ini dan tidak memperbaiki kegagalan tersebut sampai dengan pemberian surat peringatan ketiga;\r\n\r\n2Apabila salah satu Pihak jatuh pailit yang dibuktikan dengan putusan pengadilan;\r\n\r\n3Apabila ijin usaha salah satu Pihak dicabut atau tidak dapat diperbaharui/diperpanjang lagi; atau menghentikan usahanya baik sementara maupun selamanya;\r\n\r\n4Apabila salah satu Pihak menyerahkan baik sebagian maupun seluruh pelaksanaan Perjanjian ini kepada pihak ketiga, tanpa mendapat ijin tertulis terlebih dahulu dari Pihak lainnya.\r\n\r\n5Apabila terjadi perubahan aspek hukum serta regulasi sehingga terdapat perintah dari Regulator untuk mengakhiri Perjanjian ini.\r\n\r\n4Pengakhiran Perjanjian ini tidak menghapuskan hak dan kewajiban Para Pihak yang timbul sebelum efektifnya Pengakhiran.\r\n\r\n5Untuk keperluan pengakhiran Perjanjian ini maka Para Pihak sepakat untuk mengesampingkan ketentuan-ketentuan yang termaktub dalam Pasal 1266 Kitab Undang-undang Hukum Perdata sebatas diharuskan adanya putusan pengadilan terlebih dahulu untuk membatalkan atau mengakhiri Perjanjian ini.\r\n\r\nPASAL 13\r\n\r\nPERNYATAAN PARA PIHAK\r\n\r\nPara Pihak dalam Perjanjian dengan ini menyatakan dan menjamin kepada pihak lainnya bahwa :\r\n\r\n1Masing-masing Pihak adalah subjek hukum, perseroan terbatas yang berdiri secara sah didirikan dan tunduk kepada hukum dari yurisdiksi dimana ia berdiri dan memiliki kewenangan untuk memiliki harta kekayaannya serta untuk melaksanakan kegiatan usaha sebagaimana dilaksanakan di setiap wilayah hukum dimana mereka berada.\r\n\r\n2Masing-masing Pihak yang menandatangani Perjanjian ini merupakan wakil-wakil yang sah dari masing-masing Pihak sehingga Perjanjian ini merupakan Perjanjian yang sah dan mengikat bagi Para Pihak.\r\n\r\n3Masing-masing Pihak berhak dan memiliki kewenangan penuh untuk membuat dan melaksanakan Perjanjian dan bahwa Perjanjian ini adalah sah dan setiap kewajiban di dalamnya adalah mengikat dan dapat diberlakukan sesuai dengan ketentuan dalam Perjanjian.\r\n\r\n4Penandatanganan dan pelaksanaan Perjanjian ini tidak akan mengakibatkan pelanggaran terhadap perjanjian lain dimana Para Pihak tersebut menjadi salah satu Pihak atau yang mengikat terhadapnya; ataupun bertentangan dengan atau melanggar undang-undang, perintah, keputusan, atau peraturan-peraturan yang mengikatnya atau yang berlaku terhadap kegiatan usahanya, ataupun harta kekayaan dan asetnya.\r\n\r\n5Pihak Pertama dengan ini menyatakan kesanggupan dan kesediaannya untuk melunasi seluruh pembayaran yang menjadi kewajibannya, yang mana seluruh pembayaran tersebut wajib dibayarkan berdasarkan surat tagihan / invoice yang akan diterbitkan oleh Pihak Kedua.\r\n\r\n6Pihak Kedua dengan ini menyatakan sebagai berikut :\r\n\r\n1kesanggupan dan kesediaannya untuk bertanggung jawab dalam melaksanakan Pekerjaan berdasarkan Perjanjian ini dan PO yang akan diterbitkan Pihak Pertama, termasuk namun tidak terbatas pada ketepatan waktu pengiriman, SLA dan jaminan harga di setiap Service Center (apabil ada), dan kualitas Barang, serta dengan kemampuan terbaiknya menjamin akan meminimalisir resiko yang dapat terjadi pada Pihak Pertama berdasarkan Perjanjian ini.\r\n\r\n1membebaskan dan menjamin Pihak Pertama dari segala kerugian, tuntutan, maupun gugatan yang terbukti timbul akibat kelalaian atau kesalahan Pihak Kedua dan/atau personel Pihak Kedua dalam melaksanakan kewajibannya berdasarkan Perjanjian ini.\r\n\r\n7Pernyataan dalam pasal ini adalah benar dan akurat sejak tanggal Perjanjian sampai dengan masa berlakunya Perjanjian ini.\r\n\r\nPASAL 14\r\n\r\nKORESPONDENSI\r\n\r\n1Pemberitahuan Secara Tertulis.\r\n\r\nSuatu Komunikasi diberikan kepada suatu Pihak berdasarkan Perjanjian ini harus secara tertulis dan dialamatkan sesuai dengan alamat yang tertera menurut Perjanjian ini, atau kepada alamat lain yang diberitahukan kemudian secara tertulis oleh Pihak tersebut. Dalam hal terjadi perubahan atau alamat terakhir yang tercatat pada masing-masing Pihak, maka perubahan tersebut harus diberitahukan secara tertulis kepada Pihak lain dalam Perjanjian ini selambat-lambatnya 5 (lima) Hari Kerja sebelum terjadi perubahan alamat yang dimaksud. Jika perubahan alamat tersebut tidak diberitahukan, maka Komunikasi, surat-menyurat atau pemberitahuan-pemberitahuan berdasarkan Perjanjian ini dianggap telah diberikan sebagaimana mestinya dengan dikirimkannya surat atau pemberitahuan tersebut sesuai dengan alamat terakhir yang tercatat pada masing-masing Pihak;\r\n\r\n2Penyampaian Pemberitahuan.\r\n\r\nSuatu Komunikasi harus disampaikan dengan langsung atau melalui kurir atau pos tercatat, atau dikirim melalui e-mail. Suatu Komunikasi akan dianggap telah diterima:\r\n\r\n1Apabila pengiriman disampaikan secara langsung antara jam 09.00 sampai dengan 17.00 pada setiap Hari Kerja, pada saat telah dikirimkan atau diterima;\r\n\r\n2Bila diposkan dengan pos tercatat, pada Hari Kerja ke-5 (lima) setelah tanggal diposkan; atau\r\n\r\n3Bila dikirim melalui e-mail antara jam 09.00 sampai dengan 17.00 pada suatu Hari Kerja, ketika telah berhasil dikirimkan\r\n\r\n3Sepanjang tidak ditentukan lainnya maka setiap komunikasi antara Pihak Pertama dan Pihak Kedua dilakukan sesuai dengan ketentuan sebagai berikut:\r\n\r\nUntuk Pihak Pertama alamat komunikasi adalah:\r\n\r\nPT. Visionet Data Internasional\r\n\r\nAlamat: Cyber Park, Jalan Boulevard Gajah mada No 2120, Lippo\r\n\r\nVillage, Kota Tangerang 15139\r\n\r\nNo. Telepon: (021) 55777678\r\n\r\nE-mail: purchasing@visionet.co.id\r\n\r\nUP: Purchasing Departemen\r\n\r\nUntuk Pihak Kedua alamat komunikasi adalah:\r\n\r\nPT Sanjaya Amar Persada Sawangan.\r\n\r\nAlamat: BSI Blok G1 No.129 RT 001 RW 012 Pengasinan Sawangan Depok\r\n\r\nNo. Telepon: 0818775268\r\n\r\nE-mail: tonny.sanjaya@gmail.com\r\n\r\nUP: Tonny Kurnia Sanjaya\r\n\r\nPASAL 15\r\n\r\nHUKUM YANG BERLAKU DAN PENYELESAIAN PERSELISIHAN\r\n\r\nPerjanjian ini dibuat berdasarkan hukum Indonesia. Apabila terjadi perselisihan atas Perjanjian ini maka Para Pihak setuju dan sepakat menyelesaikan secara musyawarah untuk mufakat. Dalam hal musyawarah untuk mufakat tidak dapat mencapai kesepakatan dalam waktu 30 (tiga puluh) hari kalender, maka Para Pihak sepakat untuk memilih Pengadilan Negeri Jakarta Selatan untuk penyelesaian perselisihan.\r\n\r\nPASAL 16\r\n\r\nLAIN-LAIN\r\n\r\n1Hal-hal yang belum cukup diatur dalam Perjanjian ini serta perubahan, perbaikan ataupun penambahan terhadap syarat dan ketentuan dalam Perjanjian ini akan ditentukan kemudian secara musyarawah mufakat oleh Para Pihak dan akan dituangkan secara tertulis dan ditandatangani oleh Para Pihak.\r\n\r\n2Hak dan kewajiban masing-masing Pihak berdasarkan Perjanjian ini tidak dapat dialihkan tanpa persetujuan tertulis terlebih dahulu dari Pihak lainnya. Setiap usaha untuk mengalihkan suatu hak, tugas dan kewajiban dari Perjanjian ini tanpa persetujuan Pihak lainnya adalah tidak sah;\r\n\r\n3Perjanjian akan tetap berlaku dalam hal terjadi penggabungan, peleburan, pengambilalihan dan perubahan kepemilikan perseroan baik terjadi pada Pihak Pertama atau Pihak Kedua .\r\n\r\n4Jika salah satu ketentuan dari Perjanjian ini ditahan karena tidak berlaku, tidak sah atau tidak dapat dilaksanakan, hal ini tidak akan mempengaruhi keberlakuan, keabsahan atau pelaksanaan ketentuan-ketentuan lainnya. Namun demikian, Para Pihak akan sesegera mungkin mengganti ketentuan tersebut dengan ketentuan baru yang sedapat mungkin mempunyai penafsiran yang paling dekat dengannya;\r\n\r\nDemikian Perjanjian ini dibuat dan ditandatangani oleh Para Pihak pada hari, tanggal dan tempat sebagaimana disebut pada bagian awal Perjanjian ini dalam rangkap 2 (dua) asli masing-masing bermeterai cukup dan mempunyai kekuatan hukum yang sama.\r\n\r\nPIHAK PERTAMAPIHAK KEDUA\r\n\r\nPT VISIONET DATA INTERNASIONALPT Sanjaya Amar Persada Sawangan...\r\n\r\nSuyanto HalimJak Tanti.Bambang Jaya Supena...\r\n\r\nPresiden DirekturDirektur Direktur Utama\r\n\r\nLampiran 1\r\n\r\nBarang\r\n\r\nNo | Part Name | Type Mesin | Harga/Unit | Kondisi\r\n1 | Touchscreen NCR SS22E | NCR | Rp                   1.500.000 | Second Good\r\n2 | Kamera Bawah ATMNCR SS22E | NCR | Rp                   1.000.000 | Second Good\r\n3 | Kamera Atas ATM NCR | NCR | Rp                   1.000.000 | Second Good\r\n4 | LCD NCR | NCR | Rp                   1.000.000 | Second Good\r\n5 | Card Reader NCR SS22E | NCR | Rp                   2.000.000 | Second Good\r\n6 | PC Estoril | NCR | Rp                   4.500.000 | Second Good\r\n7 | Dispenser Control Top Lvl Assy Unit SS22E | NCR | Rp                   1.500.000 | Second Good\r\n8 | Presenter | NCR | Rp                   3.000.000 | Second Good\r\n9 | Air Filter | NCR | Rp                      200.000 | Second Good\r\n10 | Interface | NCR | Rp                      400.000 | Second Good\r\n11 | Pick Module | NCR | Rp                      500.000 | Second Good\r\n12 | Tquale | NCR | Rp                      100.000 | Second Good\r\n13 | Tube | NCR | Rp                        50.000 | Second Good\r\n14 | Kabel Data Penyambung Interface Atas dan Kabel Data | NCR | Rp                      100.000 | Second Good\r\n15 | KUNCI KOMBINASI | NCR | Rp                      400.000 | Second Good\r\n16 | KUNCI TOMBAK | NCR | Rp                      400.000 | Second Good\r\n17 | PSU NCR SS22E | NCR | Rp                      800.000 | Second Good\r\n18 | Cup Vacum | NCR | Rp                          5.000 | Second Good\r\n19 | Feed Shaft | Diebold | Rp                      140.000 | Second Good\r\n20 | Streeper Wheel | Diebold | Rp                        20.000 | Second Good\r\n21 | Printer (DIEBOLD) | Diebold | Rp                   1.500.000 | Second Good\r\n22 | Kamera Bawah (DIEBOLD) | Diebold | Rp                   1.000.000 | Second Good\r\n23 | Fascia bawah (DIEBOLD) | Diebold | Rp                   1.500.000 | Second Good\r\n24 | Fascia atas (DIEBOLD) | Diebold | Rp                   2.500.000 | Second Good\r\n25 | HDD 500GB NG5500 (DIEBOLD) | Diebold | Rp                      250.000 | Second Good\r\n26 | Take Away | Diebold | Rp                        20.000 | Second Good\r\n27 | Kamera Atas Diebold NG5500 | Diebold | Rp                   1.000.000 | Second Good\r\n28 | Stacker NG5500 | Diebold | Rp                   3.060.000 | Second Good\r\n29 | Card Reader NG5500 | Diebold | Rp                   2.000.000 | Second Good\r\n30 | Tombol SOP NG5500 | Diebold | Rp                      500.000 | Second Good\r\n31 | AFD Transport NG5500 | Diebold | Rp                   2.700.000 | Second Good\r\n32 | Pintu Faskia Atas PC 280 ( Tarik Atas ) | Wincor 280 | Rp                   2.000.000 | Second Good\r\n33 | Motorized Card ReaderICT3S5 | Wincor 280 | Rp                   2.000.000 | Second Good\r\n34 | Stacker + CCA + AGT | Wincor 280 | Rp                   1.950.000 | Second Good\r\n35 | Double Extactor Unit MDMS CDM V4 + Kable Flexibel | Wincor 280 | Rp                      600.000 | Second Good\r\n36 | Shutter-Lite DC-Motor Assy PC 280 | Wincor 280 | Rp                      800.000 | Second Good\r\n37 | PC Core Wincor PC 280 + HDD Windows 7 | Wincor 280 | Rp                   3.500.000 | Second Good\r\n38 | LCD TFT ,15\" Open-Frame + Kabel Power | Wincor 280 | Rp                   1.200.000 | Second Good\r\n39 | Pintu Faskia Atas PC 280 ( Tarik Depan ) | Wincor 280 | Rp                   3.500.000 | Second Good\r\n40 | Kamera Atas + Kabel | Wincor 280 | Rp                   1.250.000 | Second Good\r\n41 | Keyboard J6 EPP INT + Kabel power (WINCOR) | Wincor 280 | Rp                   1.500.000 | Second Good\r\n42 | PSU | Wincor 280 | Rp                      350.000 | Second Good\r\n43 | Power Distributor | Wincor 280 | Rp                      100.000 | Second Good\r\n44 | Kabel Power + Kabel VGA LCD Wincor | Wincor 280 | Rp                      200.000 | Second Good\r\n45 | TP 13 Receipt Printer | Wincor 280 | Rp                      500.000 | Second Good\r\n46 | Keyboard EPP J6 INT | Wincor 280 | Rp                   1.500.000 | Second Good\r\n47 | Kabel FDK EPP J6 | Wincor 280 | Rp                      250.000 | Second Good\r\n48 | Keyboard EPP J6.1 IDN | Wincor 280 | Rp                   1.500.000 | Second Good\r\n49 | Spesial Electronik | Wincor 280 | Rp                   1.000.000 | Second Good\r\n50 | CARD READER CHD V2CU ACT VERSION | Wincor 280 | Rp                   1.000.000 | Second Good\r\n51 | DISTRIBUTOR BOARD 4X WITH COVER WINCOR 280 | Wincor 280 | Rp                      350.000 | Second Good\r\n52 | BETTLE MINI CPU 280 | Wincor 280 | Rp                   2.100.000 | Second Good\r\n53 | Kabel SOP | Wincor 280 | Rp                      150.000 | Second Good\r\n54 | Kabel Power Card Reader | Wincor 280 | Rp                      150.000 | Second Good\r\n\r\nLampiran 2\r\n\r\nGaransi\r\n\r\n4.1Garansi berlaku 3 (satu) bulan\r\n\r\n4.2Cara klaim garansi : Apabila Barang yang sudah dilakukan Quality Control dalam jangka waktu 7 (tujuh) hari kerja oleh Pihak Pertama dan ditemukan ada kerusakan (bad) maka segera konfirmasi ke Pihak Kedua. Maka Pihak Kedua akan mengirimkan Barang penggantinya dalam waktu 1 [satu] hari kerja.\r\n\r\n4.3Ketentuan klaim garansi : Barang akan sepenuhnya diganti dengan Barang pengganti yang sama atau lebih tinggi atau sesuai dengan ketentuan yang berlaku dan disepakati bersama oleh Para Pihak apabila ditemukan kerusakan (bad) dengan syarat tidak merusak segel warranty atau membongkar Barang tersebut.\r\n\r\nINSTRUCTIONS (STRICT - MUST FOLLOW):\r\n- Analyze the documents ONCE ONLY.\r\n- Produce EXACTLY ONE JSON OBJECT.\r\n- DO NOT repeat, revise, regenerate, or self-correct conclusions.\r\n- DO NOT use markdown, code blocks, bullet points, or backticks.\r\n- DO NOT wrap JSON inside any other structure or explanation.\r\n- Output MUST be valid, machine-parseable JSON.\r\n- Any violation invalidates the result.\r\n\r\nTASK DEFINITION:\r\n1. Identify ALL TOPICS from the REFERENCE DOCUMENT only.\r\n   - Topic = value in column \"Topik\".\r\n   - For each topic, search the SIMILAR TOPIC WORD(S) in the uploaded document.\r\n   - Similar words include synonyms, equivalent legal terms, Indonesian-English variations, and minor OCR spelling variations, as long as the meaning is preserved.\r\n   - The search applies to all parts of the document, including Pasal, Lampiran, and miscellaneous sections (e.g. \"Lain-lain\").\r\n   - A topic is considered FOUND if the topic meaning appears anywhere in the uploaded document, regardless of section or title.\r\n\r\n2. Location recording rules:\r\n   - If the topic meaning is found, record the exact location where it appears.\r\n     - If the content is under a Pasal, use \"Pasal X\".\r\n     - If no Pasal exists, use the closest structural identifier from the uploaded document (e.g. \"Bagian\", \"Bab\", \"Angka\", \"Ayat\", \"Poin\", or similar).\r\n   - If the topic meaning appears in multiple locations, create separate entries for each location.\r\n   - If the topic meaning does NOT exist at all, still create an entry with:\r\n     - Posisi = \"Tidak Ditemukan\".\r\n\r\n3. Verification scope:\r\n   - Verification MUST be based ONLY on:\r\n     - Topik (from reference only)\r\n     - Inti Klausul (from reference only)\r\n     - Note (from reference only)\r\n   - FIRST evaluate the \"Note\" field to determine whether the topic is applicable to the uploaded document.\r\n   - If the \"Note\" indicates the topic is NOT applicable to the uploaded document, EXCLUDE that topic from verification details and percentage calculations.\r\n   - Do NOT infer clauses that are not explicitly or semantically present.\r\n\r\n4. Clause validation:\r\n   - Determine whether the uploaded document satisfies the Inti Klausul for each applicable topic.\r\n   - Ignore minor OCR spelling errors if the meaning is preserved.\r\n\r\n5. Percentage calculation:\r\n   - Percentage = (Number of applicable topics that meet Inti Klausul ÷ Total applicable reference topics) × 100.\r\n   - Round to a whole number.\r\n\r\n6. Final decision:\r\n   - Status = \"VALID\" if all High-risk applicable topics are compliant and overall consistency is met.\r\n   - Status = \"TIDAK VALID\" if one or more required topics are missing, incorrect, or contradictory.\r\n   - The verdict MUST be consistent with the findings.\r\n\r\nRULES:\r\n- Use Bahasa Indonesia ONLY.\r\n- Maintain internal consistency.\r\n- Do NOT contradict your own verdict.\r\n- Do NOT generate more than one JSON object.\r\n\r\nFINAL OUTPUT FORMAT (SINGLE JSON OBJECT ONLY):\r\n\r\n{\r\n  \"status\": \"VALID | TIDAK VALID\",\r\n  \"ringkasan\": \"Ringkasan singkat, faktual, dan konsisten dengan hasil verifikasi\",\r\n  \"persentase\": \"0-100%\",\r\n  \"detail\": [\r\n    {\r\n      \"Topik\": \"Topik referensi\",\r\n      \"Posisi\": \"Pasal X | Bagian/Bab/Poin | Tidak Ditemukan\",\r\n      \"deskripsi\": \"Penjelasan hasil verifikasi terhadap inti klausul\"\r\n    }\r\n  ]\r\n}\r\n\r\nAfter the closing brace, append EXACT TEXT:\r\nVERIFICATION COMPLETE" },
                new { role = "user", content = prompt }
            },
            temperature = 0.7,
            max_tokens = -1,
            stream = false,
        };


        var response = await _httpClient.PostAsJsonAsync("v1/chat/completions", request);
        response.EnsureSuccessStatusCode();

        var json = await response.Content.ReadAsStringAsync();
        var doc = JsonDocument.Parse(json);
        if (Regex.IsMatch(doc.RootElement
                        .GetProperty("choices")[0]
                        .GetProperty("message")
                        .GetProperty("content")
                        .GetString(), @"\bgenerate\s*otp\b",RegexOptions.IgnoreCase)
            ||
                        Regex.IsMatch(doc.RootElement
                        .GetProperty("choices")[0]
                        .GetProperty("message")
                        .GetProperty("content")
                        .GetString(), @"\bwait_backend\b", RegexOptions.IgnoreCase))
        {
            GenerateOTP();
        }
        return doc.RootElement
                    .GetProperty("choices")[0]
                    .GetProperty("message")
                    .GetProperty("content")
                    .GetString();
    }

    public void GenerateOTP()
    {
        Random random = new Random();

        int randomSixDigitNumber = random.Next(0, 1000000);

        string formattedNumber = randomSixDigitNumber.ToString("D6");

        Console.WriteLine("Membuat dan Mengirim OTP: " + formattedNumber);
    }
}
